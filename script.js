let origBoard,huPlayer="O",aiPlayer="X";const winCombos=[[0,1,2],[3,4,5],[6,7,8],[0,4,8],[6,4,2],[2,5,8],[1,4,7],[0,3,6]],cells=document.querySelectorAll(".cell");function selectSym(e){huPlayer=e,aiPlayer="O"===e?"X":"O",origBoard=Array.from(Array(9).keys());for(let e=0;e<cells.length;e++)cells[e].addEventListener("click",turnClick,!1);"X"===aiPlayer&&turn(bestSpot(),aiPlayer),document.querySelector(".selectSym").style.display="none"}function startGame(){document.querySelector(".endgame").style.display="none",document.querySelector(".endgame .text").innerText="",document.querySelector(".selectSym").style.display="block";for(let e=0;e<cells.length;e++)cells[e].innerText="",cells[e].style.removeProperty("background-color")}function turnClick(e){"number"==typeof origBoard[e.target.id]&&(turn(e.target.id,huPlayer),checkWin(origBoard,huPlayer)||checkTie()||turn(bestSpot(),aiPlayer))}function turn(e,r){origBoard[e]=r,document.getElementById(e).innerHTML=r;let t=checkWin(origBoard,r);t&&gameOver(t),checkTie()}function checkWin(e,r){let t=e.reduce((e,t,l)=>t===r?e.concat(l):e,[]),l=null;for(let[e,n]of winCombos.entries())if(n.every(e=>t.indexOf(e)>-1)){l={index:e,player:r};break}return l}function gameOver(e){for(let r of winCombos[e.index])document.getElementById(r).style.backgroundColor=e.player===huPlayer?"blue":"red";for(let e=0;e<cells.length;e++)cells[e].removeEventListener("click",turnClick,!1);declareWinner(e.player===huPlayer?"You win!":"You Lose!")}function declareWinner(e){document.querySelector(".endgame").style.display="block",document.querySelector(".endgame .text").innerText=e}function emptySquares(){return origBoard.filter((e,r)=>r===e)}function bestSpot(){return minimax(origBoard,aiPlayer).index}function checkTie(){if(0===emptySquares().length){for(cell of cells)cell.style.backgroundColor="#BEE6F9",cell.removeEventListener("click",turnClick,!1);return declareWinner("Tied!"),!0}return!1}function minimax(e,r){var t=emptySquares(e);if(checkWin(e,huPlayer))return{score:-10};if(checkWin(e,aiPlayer))return{score:10};if(0===t.length)return{score:0};var l=[];for(let o=0;o<t.length;o++){var n={};if(n.index=e[t[o]],e[t[o]]=r,n.score=r===aiPlayer?minimax(e,huPlayer).score:minimax(e,aiPlayer).score,e[t[o]]=n.index,r===aiPlayer&&10===n.score||r===huPlayer&&-10===n.score)return n;l.push(n)}let o,c;if(r===aiPlayer){c=-1e3;for(let e=0;e<l.length;e++)l[e].score>c&&(c=l[e].score,o=e)}else{c=1e3;for(let e=0;e<l.length;e++)l[e].score<c&&(c=l[e].score,o=e)}return l[o]}startGame();